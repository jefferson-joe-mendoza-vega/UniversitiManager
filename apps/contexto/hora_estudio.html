<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hora de estudio</title>
    <!-- Bootstrap CSS para estilos rápidos y responsivos -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- D3.js CDN -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <!-- Estilos personalizados -->
    <style>
        /* Centrar el contenido vertical y horizontalmente */
        .content {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh; /* Ocupa al menos la altura completa de la ventana */
            padding: 20px;
            background-color: #f0f4f8;
        }

        /* Estilo para el contenedor del diagrama */
        #diagram {
            width: 100%;
            max-width: 800px;
            height: 300px; /* Ajustada la altura para tres nodos */
            margin-top: 50px;
        }

        /* Responsividad para dispositivos móviles */
        @media (max-width: 576px) {
            #diagram {
                max-width: 100%;
                height: 250px; /* Ajuste de altura para pantallas pequeñas */
            }
        }

        /* Estilos para los nodos del diagrama */
        .node {
            cursor: pointer;
        }

        /* Estilo para el texto dentro de los nodos */
        .node-text {
            fill: #ffffff;
            font-size: 1rem;
            text-anchor: middle;
            dominant-baseline: middle;
        }

        /* Estilo para las líneas de conexión */
        .links line {
            stroke: #2c3e50;
            stroke-width: 2;
        }

        /* Estilo para las flechas */
        .links path {
            stroke: #2c3e50;
            stroke-width: 2;
        }
    </style>
</head>
<body>
    <div class="content">
        <!-- Contenedor para el diagrama de flujo -->
        <svg id="diagram"></svg>
    </div>

    <!-- Script para crear el diagrama de flujo con D3.js -->
    <script>
        // Configuración del SVG
        const svg = d3.select("#diagram")
                      .attr("width", "100%")
                      .attr("height", 300);

        const width = parseInt(svg.style("width"));
        const height = parseInt(svg.style("height"));

        // Datos de los nodos con etiquetas
        const nodes = [
            { id: "entorno de estudio TOBY", x: width / 2, y: 50 },  // Primer rectángulo
            { id: "prompts/notion", x: width / 2, y: 150 },           // Segundo rectángulo
            { id: "quiz and tallk gpt drive", x: width / 2, y: 250 }         // Tercer rectángulo
        ];

        // Datos de las conexiones (links)
        const links = [
            { source: "entorno de estudio TOBY", target: "prompts/notion" },
            { source: "prompts/notion", target: "quiz and tallk gpt drive" }
        ];

        // Crear grupos para enlaces y nodos
        const linkGroup = svg.append("g")
                             .attr("class", "links");

        const nodeGroup = svg.append("g")
                             .attr("class", "nodes");

        // Definir la flecha para las conexiones
        svg.append("defs").append("marker")
            .attr("id", "arrow")
            .attr("viewBox", "0 0 10 10")
            .attr("refX", 5)
            .attr("refY", 5)
            .attr("markerWidth", 6)
            .attr("markerHeight", 6)
            .attr("orient", "auto-start-reverse")
            .append("path")
            .attr("d", "M 0 0 L 10 5 L 0 10 Z")
            .attr("fill", "#2c3e50");

        // Dibujar las líneas de conexión
        linkGroup.selectAll("line")
                 .data(links)
                 .enter()
                 .append("line")
                 .attr("x1", d => getNodeById(d.source).x)
                 .attr("y1", d => getNodeById(d.source).y + 20)
                 .attr("x2", d => getNodeById(d.target).x)
                 .attr("y2", d => getNodeById(d.target).y - 20)
                 .attr("stroke", "#2c3e50")
                 .attr("stroke-width", 2)
                 .attr("marker-end", "url(#arrow)");

        // Dibujar los rectángulos (nodos)
        nodeGroup.selectAll("rect")
                 .data(nodes)
                 .enter()
                 .append("rect")
                 .attr("x", d => d.x - 100) // Ajusta la posición X para centrar el rectángulo
                 .attr("y", d => d.y - 20)
                 .attr("width", 200)
                 .attr("height", 40)
                 .attr("rx", 10) // Bordes redondeados
                 .attr("ry", 10)
                 .attr("fill", "#3498db")
                 .attr("stroke", "#2980b9")
                 .attr("stroke-width", 2);

        // Añadir el texto a los nodos
        nodeGroup.selectAll("text")
                 .data(nodes)
                 .enter()
                 .append("text")
                 .attr("x", d => d.x)
                 .attr("y", d => d.y + 5)
                 .attr("text-anchor", "middle")
                 .attr("fill", "#ffffff")
                 .attr("font-size", "1rem")
                 .text(d => d.id);

        // Función para obtener un nodo por su ID
        function getNodeById(id) {
            return nodes.find(node => node.id === id);
        }

        // Responsividad: actualizar el diagrama al cambiar el tamaño de la ventana
        window.addEventListener("resize", () => {
            const newWidth = parseInt(svg.style("width"));
            // Actualizar posiciones X si la pantalla cambia de tamaño
            nodes.forEach(node => node.x = newWidth / 2);

            // Redibujar las líneas
            linkGroup.selectAll("line")
                     .attr("x1", d => getNodeById(d.source).x)
                     .attr("y1", d => getNodeById(d.source).y + 20)
                     .attr("x2", d => getNodeById(d.target).x)
                     .attr("y2", d => getNodeById(d.target).y - 20);

            // Redibujar los rectángulos
            nodeGroup.selectAll("rect")
                     .attr("x", d => d.x - 100);

            // Redibujar el texto
            nodeGroup.selectAll("text")
                     .attr("x", d => d.x)
                     .attr("y", d => d.y + 5);
        });
    </script>

    <!-- Bootstrap JS (opcional, para componentes interactivos) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>
</body>
</html>
